(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16639,        380]
NotebookOptionsPosition[     14716,        342]
NotebookOutlinePosition[     15069,        358]
CellTagsIndexPosition[     15026,        355]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["I need it to look like this", "Subsubsection"]], \
"Text",
 CellChangeTimes->{{3.739091986495224*^9, 
  3.7390919904825697`*^9}},ExpressionUUID->"98d269ac-9a8c-461c-b6bc-\
0c33cb0acca3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trainingset", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "\[Rule]", "1.3"}], ",", 
     RowBox[{"2", "\[Rule]", "2.4"}], ",", 
     RowBox[{"3", "\[Rule]", "4.4"}], ",", 
     RowBox[{"4", "\[Rule]", "5.1"}], ",", 
     RowBox[{"6", "\[Rule]", "7.3"}]}], "}"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.739091913343566*^9, 3.7390919133540688`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"12da503a-6a19-443d-8f30-71e96ebdc62a"],

Cell["So that I can use", "Text",
 CellChangeTimes->{{3.739102179921947*^9, 
  3.739102184280846*^9}},ExpressionUUID->"abb52d3b-dff3-4a19-b92e-\
cbee6ac862df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"Predict", "[", 
    RowBox[{"trainingset", ",", 
     RowBox[{"Method", "\[Rule]", "\"\<LinearRegression\>\""}]}], "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.739091923208846*^9, 3.739091928115279*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"050fb27a-8875-40f6-99ac-a03322f8aa26"],

Cell["And then obtain", "Text",
 CellChangeTimes->{{3.739102189759202*^9, 
  3.739102192815425*^9}},ExpressionUUID->"da672b21-5885-456c-a43b-\
fadbf1ac41bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p", "[", "1.5", "]"}]], "Code", "Input",
 CellChangeTimes->{{3.739041845151033*^9, 3.7390418461117268`*^9}, {
  3.739092031318633*^9, 3.739092041563298*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"5a30da7a-e178-4a57-99d6-8e212b49f14e"],

Cell[BoxData["2.0842342210822102`"], "Output",
 CellChangeTimes->{{3.739092032242441*^9, 3.739092042470051*^9}, 
   3.73910309573433*^9, {3.739117609062818*^9, 3.739117619637301*^9}},
 CellLabel->"Out[9]=",ExpressionUUID->"2b1989e1-c95a-4aa6-9b1c-a09ca3373c53"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get the Data", "Subsubsection",
 CellChangeTimes->{{3.73909239424166*^9, 3.739092398774824*^9}, {
  3.739092468096184*^9, 3.739092469312755*^9}, {3.739108212845667*^9, 
  3.739108215098493*^9}},ExpressionUUID->"fd8b3198-1947-4c21-ae06-\
a71bfe4ac46b"],

Cell["This is the location of the data on an Excel file:", "Text",
 CellChangeTimes->{{3.739108217431994*^9, 
  3.739108230850452*^9}},ExpressionUUID->"5ae7a89c-f9ce-45e2-9674-\
ed82cc6e67d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "originalFile", "=", 
   "\"\</Users/jaimebuitrago/Dropbox/Jaime/Wolfram Summer \
School/EnergyJuneMA.xlsx\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.7390923271501913`*^9, 3.739092350287402*^9}, 
   3.739092420149015*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"39875c20-e080-454c-b290-b05c3e3d6e63"],

Cell["Use SemanticImport to get the data from the excel file", "Text",
 CellChangeTimes->{{3.739092444339315*^9, 3.739092451774419*^9}, {
  3.73910819286698*^9, 
  3.7391082034154177`*^9}},ExpressionUUID->"cb123cdc-d02e-4f32-b90d-\
111e0c611f88"],

Cell[BoxData[
 RowBox[{
  RowBox[{"allData1", "=", " ", 
   RowBox[{"SemanticImport", "[", "originalFile", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.739092357919092*^9, 3.7390923644002028`*^9}, {
   3.739092428361861*^9, 3.7390924558992157`*^9}, {3.739092519093815*^9, 
   3.7390925226873407`*^9}, 3.7391034580093613`*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"90dde945-14d7-4f19-822d-637a75e9f9da"],

Cell["\<\
I only need the association from the first to the third column : DateHour -> \
Actual but element by element.\
\>", "Text",
 CellChangeTimes->{{3.739108242344685*^9, 
  3.739108248992826*^9}},ExpressionUUID->"235c57a8-47f1-4a60-be87-\
75ff2609d5c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trainingset", "=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"#DateHour", " ", "\[Rule]", " ", "#Actual"}], "]"}], " ", "/@", 
    
    RowBox[{"Normal", "[", "allData1", "]"}]}]}], ";"}]], "Code",
 CellChangeTimes->{{3.739103462902495*^9, 3.739103521595125*^9}, 
   3.739108109861494*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"e2009084-8be4-4db7-a409-1b52ff7b7fcb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Train a Neural Network", "Subsubsection",
 CellChangeTimes->{{3.7391081200180883`*^9, 3.739108149246619*^9}, {
  3.739108265140738*^9, 
  3.739108272937531*^9}},ExpressionUUID->"5129ed10-a50e-40d7-9050-\
8ec91b0c883f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p", " ", "=", " ", 
  RowBox[{"Predict", "[", 
   RowBox[{"trainingset", ",", 
    RowBox[{"Method", "\[Rule]", "\"\<NeuralNetwork\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.739108281083253*^9, 3.739108301140563*^9}, 
   3.7391083399404993`*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"c3ac7f32-f2dd-40ae-b912-e22964ef30eb"],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["PredictorFunction", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{
       Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
       TemplateBox[{
         TemplateBox[{
           PaneSelectorBox[{False -> GridBox[{{
                 PaneBox[
                  ButtonBox[
                   DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SquarePlusIconMedium"]], 
                   ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                   None, Evaluator -> Automatic, Method -> "Preemptive"], 
                  Alignment -> {Center, Center}, ImageSize -> 
                  Dynamic[{
                    Automatic, 3.5 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                 GraphicsBox[{{}, {{}, {
                    PointSize[0.125], 
                    GrayLevel[0.55], 
                    
                    PointBox[{{-1, 1.5}, {0, 2.3}, {1, 0.8}, {2, 2}, {
                    3, 1.3}, {4, 4.}}]}, {
                    GrayLevel[0.7], 
                    AbsoluteThickness[1.5], 
                    
                    BSplineCurveBox[{{-1, 2}, {0, 2}, {1, 1}, {2, 1}, {4, 
                    2}, {5, 4}}]}}, {}}, Axes -> {False, False}, 
                  AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, 
                  BaseStyle -> {FontFamily -> "Arial", 
                    AbsoluteThickness[1.5]}, DisplayFunction -> Identity, 
                  Frame -> {{True, True}, {True, True}}, 
                  FrameLabel -> {{None, None}, {None, None}}, FrameStyle -> 
                  Directive[
                    Thickness[Tiny], 
                    GrayLevel[0.7]], 
                  FrameTicks -> {{None, None}, {None, None}}, 
                  GridLines -> {None, None}, 
                  LabelStyle -> {FontFamily -> "Arial"}, 
                  Method -> {"ScalingFunctions" -> None}, 
                  PlotRange -> {All, All}, PlotRangeClipping -> True, 
                  PlotRangePadding -> {{1, 1}, {1, 1}}, Ticks -> {None, None},
                   Axes -> False, AspectRatio -> 1, ImageSize -> 
                  Dynamic[{
                    Automatic, 3.5 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}], Frame -> True, 
                  FrameTicks -> None, FrameStyle -> Directive[
                    Opacity[0.5], 
                    Thickness[Tiny], 
                    RGBColor[0.368417, 0.506779, 0.709798]], Background -> 
                  GrayLevel[0.94]], 
                 GridBox[{{
                    RowBox[{
                    TagBox["\"Input type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Text\"", "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Method: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"NeuralNetwork\"", "SummaryItem"]}]}}, 
                  GridBoxAlignment -> {
                   "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
                  AutoDelete -> False, 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                  GridBoxSpacings -> {
                   "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                  BaseStyle -> {
                   ShowStringCharacters -> False, NumberMarks -> False, 
                    PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
               GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               BaselinePosition -> {1, 1}], True -> GridBox[{{
                 PaneBox[
                  ButtonBox[
                   DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SquareMinusIconMedium"]], 
                   ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                   None, Evaluator -> Automatic, Method -> "Preemptive"], 
                  Alignment -> {Center, Center}, ImageSize -> 
                  Dynamic[{
                    Automatic, 3.5 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                 GraphicsBox[{{}, {{}, {
                    PointSize[0.125], 
                    GrayLevel[0.55], 
                    
                    PointBox[{{-1, 1.5}, {0, 2.3}, {1, 0.8}, {2, 2}, {
                    3, 1.3}, {4, 4.}}]}, {
                    GrayLevel[0.7], 
                    AbsoluteThickness[1.5], 
                    
                    BSplineCurveBox[{{-1, 2}, {0, 2}, {1, 1}, {2, 1}, {4, 
                    2}, {5, 4}}]}}, {}}, Axes -> {False, False}, 
                  AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, 
                  BaseStyle -> {FontFamily -> "Arial", 
                    AbsoluteThickness[1.5]}, DisplayFunction -> Identity, 
                  Frame -> {{True, True}, {True, True}}, 
                  FrameLabel -> {{None, None}, {None, None}}, FrameStyle -> 
                  Directive[
                    Thickness[Tiny], 
                    GrayLevel[0.7]], 
                  FrameTicks -> {{None, None}, {None, None}}, 
                  GridLines -> {None, None}, 
                  LabelStyle -> {FontFamily -> "Arial"}, 
                  Method -> {"ScalingFunctions" -> None}, 
                  PlotRange -> {All, All}, PlotRangeClipping -> True, 
                  PlotRangePadding -> {{1, 1}, {1, 1}}, Ticks -> {None, None},
                   Axes -> False, AspectRatio -> 1, ImageSize -> 
                  Dynamic[{
                    Automatic, 3.5 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}], Frame -> True, 
                  FrameTicks -> None, FrameStyle -> Directive[
                    Opacity[0.5], 
                    Thickness[Tiny], 
                    RGBColor[0.368417, 0.506779, 0.709798]], Background -> 
                  GrayLevel[0.94]], 
                 GridBox[{{
                    RowBox[{
                    TagBox["\"Input type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Text\"", "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Method: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"NeuralNetwork\"", "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox[
                    "\"Number of training examples: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                    TagBox["480", "SummaryItem"]}]}}, 
                  GridBoxAlignment -> {
                   "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
                  AutoDelete -> False, 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                  GridBoxSpacings -> {
                   "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                  BaseStyle -> {
                   ShowStringCharacters -> False, NumberMarks -> False, 
                    PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
               GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               BaselinePosition -> {1, 1}]}, 
            Dynamic[Typeset`open$$], ImageSize -> Automatic]}, 
          "SummaryPanel"], 
         ButtonBox[
          DynamicBox[
           ToBoxes[
            If[
             
             Or[$VersionNumber < 11.2, CurrentValue["RunningEvaluator"] =!= 
              "Local"], 
             Style["This object cannot be used as input.", "SummaryEmbed"], 
             BoxForm`EmbedSummaryLabel[PredictorFunction, 1655192, 
              Dynamic[Typeset`embedState$$]]], StandardForm]], ButtonFunction :> 
          BoxForm`EmbedSummaryInterpretation[
           PredictorFunction, 
            8970582058247713652638507494440209090098779613419693990624, 
            EvaluationBox[], 
            Dynamic[Typeset`embedState$$], StandardForm], DefaultBaseStyle -> 
          "SummaryEmbedButton", BaseStyle -> {"DialogStyle"}, Enabled -> 
          Dynamic[
            
            And[$VersionNumber >= 11.2, CurrentValue["RunningEvaluator"] === 
             "Local", Typeset`embedState$$ === "Ready"]], Appearance -> 
          Inherited, Method -> Inherited, Evaluator -> Automatic]}, 
        "SummaryEmbedGrid"], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("PredictorFunction[\[Ellipsis]]"& )],
  False,
  BoxID -> 8970582058247713652638507494440209090098779613419693990624,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.739108355200618*^9, 3.7391176740691566`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"60682d3c-3473-4ead-a694-9220229accd9"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1454, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 210, 4, 40, "Text",ExpressionUUID->"98d269ac-9a8c-461c-b6bc-0c33cb0acca3"],
Cell[771, 26, 471, 11, 52, "Code",ExpressionUUID->"12da503a-6a19-443d-8f30-71e96ebdc62a"],
Cell[1245, 39, 159, 3, 35, "Text",ExpressionUUID->"abb52d3b-dff3-4a19-b92e-cbee6ac862df"],
Cell[1407, 44, 343, 8, 52, "Code",ExpressionUUID->"050fb27a-8875-40f6-99ac-a03322f8aa26"],
Cell[1753, 54, 157, 3, 35, "Text",ExpressionUUID->"da672b21-5885-456c-a43b-fadbf1ac41bf"],
Cell[CellGroupData[{
Cell[1935, 61, 259, 4, 46, "Code",ExpressionUUID->"5a30da7a-e178-4a57-99d6-8e212b49f14e"],
Cell[2197, 67, 261, 3, 34, "Output",ExpressionUUID->"2b1989e1-c95a-4aa6-9b1c-a09ca3373c53"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2495, 75, 257, 4, 45, "Subsubsection",ExpressionUUID->"fd8b3198-1947-4c21-ae06-a71bfe4ac46b"],
Cell[2755, 81, 192, 3, 35, "Text",ExpressionUUID->"5ae7a89c-f9ce-45e2-9674-ed82cc6e67d3"],
Cell[2950, 86, 340, 8, 52, "Code",ExpressionUUID->"39875c20-e080-454c-b290-b05c3e3d6e63"],
Cell[3293, 96, 246, 4, 35, "Text",ExpressionUUID->"cb123cdc-d02e-4f32-b90d-111e0c611f88"],
Cell[3542, 102, 406, 7, 52, "Code",ExpressionUUID->"90dde945-14d7-4f19-822d-637a75e9f9da"],
Cell[3951, 111, 259, 6, 35, "Text",ExpressionUUID->"235c57a8-47f1-4a60-be87-75ff2609d5c9"],
Cell[4213, 119, 417, 10, 52, "Code",ExpressionUUID->"e2009084-8be4-4db7-a409-1b52ff7b7fcb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4667, 134, 224, 4, 45, "Subsubsection",ExpressionUUID->"5129ed10-a50e-40d7-9050-8ec91b0c883f"],
Cell[CellGroupData[{
Cell[4916, 142, 360, 8, 30, "Input",ExpressionUUID->"c3ac7f32-f2dd-40ae-b912-e22964ef30eb"],
Cell[5279, 152, 9409, 186, 83, "Output",ExpressionUUID->"60682d3c-3473-4ead-a694-9220229accd9"]
}, Open  ]]
}, Open  ]]
}
]
*)

